<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Arab Alifbosi ‚Äî Kartochkalar</title>
<style>
:root{
  --bg:#f4f8ff; --panel:#eaf2ff; --card:#ffffff; --ink:#16324a;
  --accent:#ffd166; --btn:#0aa2ff; --btn-ink:#fff;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans","Noto Kufi Arabic",Arial,sans-serif;
  background:var(--bg); color:var(--ink);
}

/* ---------- Top ---------- */
.topbar{ text-align:center; padding:18px 12px; background:var(--panel); border-bottom:1px solid #dbe7ff; }
.topbar h1{margin:0 0 6px; font-size:clamp(18px, 3vw, 28px)}
.hint{margin:6px 0 0; color:#325c84; font-weight:600}

.toolbar{
  max-width:1100px; margin:10px auto 0; padding:0 16px;
  display:flex; gap:8px; justify-content:flex-end; flex-wrap:wrap;
}
.btn{
  background:var(--btn); color:var(--btn-ink); border:none; border-radius:10px; padding:8px 12px; cursor:pointer;
  font-weight:700; box-shadow:0 6px 16px rgba(10,162,255,.25);
}
.btn.secondary{ background:#e9f4ff; color:#0a3760; box-shadow:none; border:1px solid #cfe3ff; }
.btn.warn{ background:#ffd166; color:#4a2a00; box-shadow:0 6px 16px rgba(255,209,102,.25); }
.btn:active{transform:translateY(1px)}

/* ---------- Grid (RTL) ---------- */
.grid{
  --min:130px;
  display:grid; gap:18px; padding:18px; margin:0 auto 28px;
  grid-template-columns:repeat(auto-fill, minmax(var(--min), 1fr));
  max-width:1100px;
  direction: rtl; /* o‚Äòngdan chapga terish */
}
/* Kartochka ichida LTR, arabcha matnni alohida RTL qilamiz */
.card, .card * { direction: ltr; }

/* ---------- Card (flip) ---------- */
.card{ perspective:1000px; height:180px; }
.card-btn{ position:relative; width:100%; height:100%; border:0; background:transparent; padding:0; cursor:pointer; }
.inner{
  position:absolute; inset:0; border-radius:18px; background:var(--card);
  box-shadow:0 12px 32px rgba(0,0,0,.08);
  transition: transform .5s cubic-bezier(.2,.7,.2,1), box-shadow .2s;
  transform-style: preserve-3d;
  border:1px solid #dfe8f5;
}
.card-btn:hover .inner{ box-shadow:0 14px 40px rgba(0,0,0,.12) }
.card.is-open .inner{ transform: rotateY(180deg); }

.face{ position:absolute; inset:0; backface-visibility:hidden; border-radius:18px; display:flex; align-items:center; justify-content:center; padding:14px; }
.front{ background: radial-gradient(circle at 30% -10%, #eaf3ff, #eaf3ff 30%, #ffffff 30%); }
.letter{
  font-family:"Noto Kufi Arabic","Amiri",serif;
  font-size: clamp(46px, 9vw, 64px);
  line-height:1; color:#0a2450;
  text-shadow: 0 2px 0 #fff, 0 10px 24px rgba(10,36,80,.18);
}
.back{
  transform: rotateY(180deg);
  background:
    linear-gradient(135deg, #fff7e6, #fff),
    radial-gradient(120px 80px at 100% 0%, #ffe39b, transparent 70%),
    radial-gradient(100px 60px at 0% 100%, #cfe9ff, transparent 70%);
}
.info{ text-align:center; }
.info .big{ font-family:"Noto Kufi Arabic","Amiri",serif; font-size:40px; margin:0 0 6px; direction:rtl; }
.info .name{ margin:2px 0 10px; font-weight:800; color:#274a70; font-size:20px; }

/* rangli frontlar */
.card:nth-child(6n+1) .front{background: radial-gradient(circle at 30% -10%, #e3f7ff, #e3f7ff 30%, #fff 30%);}
.card:nth-child(6n+2) .front{background: radial-gradient(circle at 70% -10%, #ffe9f3, #ffe9f3 30%, #fff 30%);}
.card:nth-child(6n+3) .front{background: radial-gradient(circle at 20% -10%, #fff3d9, #fff3d9 30%, #fff 30%);}
.card:nth-child(6n+4) .front{background: radial-gradient(circle at 70% -10%, #ecffe9, #ecffe9 30%, #fff 30%);}
.card:nth-child(6n+5) .front{background: radial-gradient(circle at 30% -10%, #f1e9ff, #f1e9ff 30%, #fff 30%);}
.card:nth-child(6n+6) .front{background: radial-gradient(circle at 70% -10%, #ffe9e9, #ffe9e9 30%, #fff 30%);}

/* ---------- Overlay (modal) ‚Äî blur+zoom fon + animatsiya ---------- */
.overlay{
  position:fixed; inset:0; display:flex; align-items:center; justify-content:center;
  background: rgba(2,15,31,0.0);
  backdrop-filter: blur(0px) scale(1);
  z-index:50; padding:18px;
  direction: rtl;
  opacity:0; pointer-events:none;
  transition: background .35s ease, backdrop-filter .35s ease, opacity .35s ease;
}
.overlay.open{
  background: rgba(2,15,31,0.55);
  backdrop-filter: blur(3px) scale(1.02);
  opacity:1; pointer-events:auto;
}
.ov-close{
  position:absolute; left:14px; top:12px; z-index:60;
  border:none; background:var(--accent); color:#4a2a00;
  width:38px; height:38px; border-radius:50%; cursor:pointer; font-size:24px; font-weight:900;
  box-shadow:0 8px 22px rgba(0,0,0,.25);
}
.nav{
  position:absolute; inset-inline:16px; top:50%; transform:translateY(-50%);
  display:flex; justify-content:space-between; pointer-events:none;
}
.nav button{
  pointer-events:auto; width:44px; height:44px; border-radius:50%; border:none;
  background:#ffffffcc; color:#0a2b52; font-size:22px; cursor:pointer; box-shadow:0 10px 22px rgba(0,0,0,.2);
}

/* Katta karta o‚Äòlchamlari */
.card.is-large{ width:min(92vw, 460px); height:min(80vh, 520px); }

/* Ochilish/yopilish animatsiyalari */
.card.pop-in{ transform: scale(0.7) translateY(30px); opacity:0; animation: popIn .45s cubic-bezier(.25,.8,.25,1) forwards; }
.card.pop-out{ transform: scale(1) translateY(0); opacity:1; animation: popOut .35s cubic-bezier(.4,.0,.2,1) forwards; }
@keyframes popIn{
  0%{ transform:scale(0.7) translateY(30px); opacity:0; }
  60%{ transform:scale(1.05) translateY(-6px); opacity:1; }
  100%{ transform:scale(1) translateY(0); opacity:1; }
}
@keyframes popOut{
  0%{ transform:scale(1) translateY(0); opacity:1; }
  100%{ transform:scale(0.7) translateY(40px); opacity:0; }
}

/* Katta rejimda matn o‚Äòlchami */
.card.is-large .letter{ font-size: clamp(72px, 14vw, 110px); }
.card.is-large .info .big{ font-size: clamp(48px, 8vw, 80px); }
.card.is-large .info .name{ font-size: clamp(22px, 3.6vw, 32px); }

/* ---------- Dark Mode ---------- */
.dark{
  --bg:#0e1726; --panel:#0b1423; --card:#101a2b; --ink:#dbe8ff; --btn:#3aaefc; --btn-ink:#05233b;
}
.dark .topbar{border-bottom-color:#10213a}
.dark .inner{border-color:#1a2a44; box-shadow:0 8px 24px rgba(0,0,0,.5)}
.dark .front{background: radial-gradient(circle at 30% -10%, #152338, #152338 30%, #0f1b2d 30%);}
.dark .ov-close{background:#ffc95b}
.dark .btn.secondary{background:#0f2139;color:#dbe8ff;border-color:#1d3b63}
</style>
</head>
<body>
  <header class="topbar">
    <h1>Arab Alifbosi ‚Äî Kartochkalar</h1>
    <p class="hint">Kartochkaga bosing ‚Äî kattalashadi va o‚Äòqilishi ko‚Äòrinadi</p>
  </header>

  <div class="toolbar">
    <button id="btn-shuffle" class="btn">üîÄ Aralashtirish</button>
    <button id="btn-reset"   class="btn secondary">‚Ü©Ô∏è Qaytarish</button>
    <button id="btn-quiz"    class="btn warn">üß† Quiz</button>
    <button id="btn-dark"    class="btn secondary">üåó Dark</button>
  </div>

  <main>
    <section id="letters" class="grid" aria-live="polite"></section>
  </main>

  <!-- Overlay (kattalashgan karta) -->
  <div id="overlay" class="overlay" aria-hidden="true">
    <button id="ov-close" class="ov-close" aria-label="Yopish">√ó</button>
    <div class="nav">
      <button id="prev" aria-label="Oldingi">‚Äπ</button>
      <button id="next" aria-label="Keyingi">‚Ä∫</button>
    </div>
  </div>

  <!-- Quiz modal (oddiy, shu overlaydan foydalanamiz) -->
  <template id="quiz-tpl">
    <div class="quiz">
      <style>
        .quiz-wrap{background:var(--card);border-radius:18px;padding:18px;max-width:520px;width:min(92vw,520px);
                   box-shadow:0 18px 40px rgba(0,0,0,.25);border:1px solid #dfe8f5;text-align:center}
        .quiz .harf{font-family:"Noto Kufi Arabic","Amiri",serif;font-size:80px;margin:0 0 10px}
        .quiz .opts{display:grid;gap:10px;margin-top:6px}
        .quiz .opts button{padding:10px 12px;border-radius:12px;border:1px solid #cfe3ff;cursor:pointer;background:#eaf4ff;font-weight:700}
        .quiz .opts button.good{background:#d9f9d9;border-color:#7fce7f}
        .quiz .opts button.bad{background:#ffd6d6;border-color:#f28b8b}
        .quiz .foot{display:flex;justify-content:space-between;align-items:center;margin-top:12px}
        .quiz .score{font-weight:800}
      </style>
      <div class="quiz-wrap">
        <div class="harf" id="q-char"></div>
        <div class="opts" id="q-opts"></div>
        <div class="foot">
          <div class="score" id="q-score">0/0</div>
          <button class="btn" id="q-next">Keyingi</button>
        </div>
      </div>
    </div>
  </template>

<script>
/* ===== Ma‚Äôlumotlar (transliteratsiya yo‚Äòq) ===== */
const DATA = [
  H("ÿß","Alif","ÿ£ŸÑŸÅ"), H("ÿ®","Bo","ÿ®ÿßÿ°"), H("ÿ™","To","ÿ™ÿßÿ°"), H("ÿ´","Sa","ÿ´ÿßÿ°"),
  H("ÿ¨","Jim","ÿ¨ŸäŸÖ"), H("ÿ≠","Ho","ÿ≠ÿßÿ°"), H("ÿÆ","Xo","ÿÆÿßÿ°"), H("ÿØ","Dal","ÿØÿßŸÑ"),
  H("ÿ∞","Zal","ÿ∞ÿßŸÑ"), H("ÿ±","Ro","ÿ±ÿßÿ°"), H("ÿ≤","Zo","ÿ≤ÿßŸä"), H("ÿ≥","Sin","ÿ≥ŸäŸÜ"),
  H("ÿ¥","Shin","ÿ¥ŸäŸÜ"), H("ÿµ","Sod","ÿµÿßÿØ"), H("ÿ∂","Dod","ÿ∂ÿßÿØ"), H("ÿ∑","To‚Äò","ÿ∑ÿßÿ°"),
  H("ÿ∏","Zo‚Äò","ÿ∏ÿßÿ°"), H("ÿπ","Ayn","ÿπŸäŸÜ"), H("ÿ∫","G‚Äòayn","ÿ∫ŸäŸÜ"), H("ŸÅ","Fo","ŸÅÿßÿ°"),
  H("ŸÇ","Qof","ŸÇÿßŸÅ"), H("ŸÉ","Kaf","ŸÉÿßŸÅ"), H("ŸÑ","Lam","ŸÑÿßŸÖ"), H("ŸÖ","Mim","ŸÖŸäŸÖ"),
  H("ŸÜ","Nun","ŸÜŸàŸÜ"), H("Ÿá","Ha","Ÿáÿßÿ°"), H("Ÿà","Vav","ŸàÿßŸà"), H("Ÿä","Ya","Ÿäÿßÿ°"),
];
function H(char, uz, ar){ return {char, uz, ar}; }

/* ===== DOM ===== */
const root = document.getElementById('letters');
const overlay = document.getElementById('overlay');
const ovClose = document.getElementById('ov-close');
const btnPrev = document.getElementById('prev');
const btnNext = document.getElementById('next');
const btnShuffle = document.getElementById('btn-shuffle');
const btnReset   = document.getElementById('btn-reset');
const btnQuiz    = document.getElementById('btn-quiz');
const btnDark    = document.getElementById('btn-dark');
const quizTpl    = document.getElementById('quiz-tpl');

let order = [...Array(DATA.length).keys()]; // 0..27
let currentIndex = 0;
const slots = new WeakMap(); // card -> {parent, next}

/* ===== Helperlar ===== */
const el = (t,c)=>{const n=document.createElement(t); if(c) n.className=c; return n;};
const by = i => DATA[order[i]];
function shuffle(a){ for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]];} return a; }

/* ===== Grid ===== */
render();
function render(){
  root.innerHTML='';
  order.forEach((_,i)=>{
    const d = by(i);
    const card=el('div','card');
    const btn=el('button','card-btn'); btn.type='button'; btn.setAttribute('aria-label',`Harf ${d.char}, ${d.uz}`);
    const inner=el('div','inner');

    const front=el('div','face front');
    const letter=el('div','letter'); letter.textContent=d.char;
    front.appendChild(letter);

    const back=el('div','face back');
    const info=el('div','info');
    const big=el('p','big'); big.textContent=d.ar;
    const name=el('p','name'); name.textContent=d.uz;
    info.appendChild(big); info.appendChild(name);
    back.appendChild(info);

    inner.appendChild(front); inner.appendChild(back);
    btn.appendChild(inner); card.appendChild(btn); root.appendChild(card);

    btn.addEventListener('click', ()=> openLarge(card, i));
  });
}

/* ===== Katta karta ===== */
function openLarge(card, i){
  closeLarge();
  currentIndex = i;
  slots.set(card, {parent:card.parentNode, next:card.nextSibling});
  overlay.classList.add('open'); overlay.setAttribute('aria-hidden','false');
  card.classList.add('is-open','is-large','pop-in');
  overlay.appendChild(card);
  document.body.style.overflow='hidden';
}
function closeLarge(){
  if(!overlay.classList.contains('open')) return;
  const card = overlay.querySelector('.card');
  if(card){
    card.classList.remove('pop-in'); card.classList.add('pop-out');
    card.addEventListener('animationend', function handler(){
      card.removeEventListener('animationend', handler);
      card.classList.remove('is-open','is-large','pop-out');
      const slot=slots.get(card);
      if(slot && slot.parent){ slot.parent.insertBefore(card, slot.next||null); slots.delete(card); }
      overlay.classList.remove('open'); overlay.setAttribute('aria-hidden','true');
      document.body.style.overflow='';
    });
  }
}
overlay.addEventListener('click', e=>{ if(e.target===overlay) closeLarge(); });
ovClose.addEventListener('click', closeLarge);
window.addEventListener('keydown', e=>{
  if(e.key==='Escape') closeLarge();
  if(!overlay.classList.contains('open')) return;
  if(e.key==='ArrowLeft') prev(); // RTL: Left = oldingi
  if(e.key==='ArrowRight') next();
});
btnPrev.addEventListener('click', prev);
btnNext.addEventListener('click', next);

function prev(){ jump(-1); }
function next(){ jump(+1); }
function jump(delta){
  const card = overlay.querySelector('.card'); if(!card) return;
  const slot=slots.get(card);
  if(slot && slot.parent){ slot.parent.insertBefore(card, slot.next||null); slots.delete(card); }
  currentIndex = (currentIndex + delta + order.length) % order.length;
  const target = root.children[currentIndex];
  openLarge(target, currentIndex);
}

/* ===== Toolbar actions ===== */
btnShuffle.addEventListener('click', ()=>{ order = shuffle(order); render(); });
btnReset.addEventListener('click', ()=>{ order = [...Array(DATA.length).keys()]; render(); });
btnDark.addEventListener('click', ()=>{
  document.body.classList.toggle('dark');
  btnDark.textContent = document.body.classList.contains('dark') ? 'üåñ Light' : 'üåó Dark';
});

/* ===== Quiz (Viktorina) ===== */
btnQuiz.addEventListener('click', startQuiz);
function startQuiz(){
  closeLarge();

  overlay.classList.add('open'); overlay.setAttribute('aria-hidden','false');
  document.body.style.overflow='hidden';

  // UI
  const frag = quizTpl.content.cloneNode(true);
  const wrap = frag.querySelector('.quiz-wrap');
  wrap.id = 'quiz-wrap';
  overlay.appendChild(wrap);

  let score=0, total=0;
  nextQuestion();

  function nextQuestion(){
    const d = DATA[Math.floor(Math.random()*DATA.length)];
    const opts = new Set([d.uz]);
    while(opts.size<4){ opts.add(DATA[Math.floor(Math.random()*DATA.length)].uz); }
    const mix = Array.from(opts); shuffle(mix);

    wrap.querySelector('#q-char').textContent = d.char;
    const box = wrap.querySelector('#q-opts'); box.innerHTML='';
    mix.forEach(name=>{
      const b=document.createElement('button');
      b.textContent=name;
      b.addEventListener('click', ()=>{
        total++;
        if(name===d.uz){ score++; b.classList.add('good'); } else { b.classList.add('bad'); }
        wrap.querySelectorAll('#q-opts button').forEach(x=>x.disabled=true);
        upd();
      });
      box.appendChild(b);
    });
    wrap.querySelector('#q-next').onclick = ()=>{
      nextQuestion();
    };
    upd();
  }
  function upd(){ wrap.querySelector('#q-score').textContent = `${score}/${total}`; }

  // Quizni yopish ‚Äî overlay bosilsa yoki Esc
  overlay.addEventListener('click', onOv, {once:true});
  window.addEventListener('keydown', onEsc);
  function onOv(e){ if(e.target===overlay){ end(); } else { overlay.addEventListener('click', onOv, {once:true}); } }
  function onEsc(e){ if(e.key==='Escape'){ end(); } }
  function end(){
    overlay.classList.remove('open'); overlay.setAttribute('aria-hidden','true');
    document.body.style.overflow='';
    wrap.remove();
    window.removeEventListener('keydown', onEsc);
  }
}
</script>
</body>
</html>